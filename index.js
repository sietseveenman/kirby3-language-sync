(function(){"use strict";var d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.render?n("section",{staticClass:"k-sync-language-field"},[n("div",{staticClass:"k-field-label"},[e._v(e._s(e.label))]),n("k-button",{staticClass:"da-button",attrs:{icon:"wand"},on:{click:e.openDialog}},[e._v(" "+e._s(e.buttonLabel||"Synchronize")+" ")]),n("k-dialog",{ref:"dialog",attrs:{size:"small"}},[e.success?n("k-text",[e._v(" The content has been synced from "),n("span",{staticClass:"upper"},[e._v(e._s(e.syncFromLanguage))]),e._v(". ")]):n("div",[n("k-select-field",{staticClass:"mb",attrs:{options:e.otherLanguages,required:!0,label:"Select source language",name:"sync_from",help:"From which language would you like to synchronize content from?"},model:{value:e.syncFromLanguage,callback:function(i){e.syncFromLanguage=i},expression:"syncFromLanguage"}}),n("k-checkboxes-field",{attrs:{label:"Fields to synchronize",options:e.syncableFields},model:{value:e.fieldsToSync,callback:function(i){e.fieldsToSync=i},expression:"fieldsToSync"}}),n("k-button",{staticClass:"uncheck-button",attrs:{icon:"cancel-small"},on:{click:function(i){e.fieldsToSync=[]}}},[e._v(" Uncheck all ")])],1),n("template",{slot:"footer"},[n("k-button-group",[n("k-button",{attrs:{icon:"cancel",theme:e.closeButtonTheme},on:{click:e.closeDialog}},[e._v(e._s(e.success?"Sluiten":"Annuleren"))]),e.allowSync?n("k-button",{attrs:{icon:"play"},on:{click:e.getContentFromLanguage}},[e._v("Let's GO!")]):e._e()],1)],1)],2)],1):e._e()},h=[],F="",C="";function f(e,t,n,i,l,r,u,b){var s=typeof e=="function"?e.options:e;t&&(s.render=t,s.staticRenderFns=n,s._compiled=!0),i&&(s.functional=!0),r&&(s._scopeId="data-v-"+r);var o;if(u?(o=function(a){a=a||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!a&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(a=__VUE_SSR_CONTEXT__),l&&l.call(this,a),a&&a._registeredComponents&&a._registeredComponents.add(u)},s._ssrRegister=o):l&&(o=b?function(){l.call(this,(s.functional?this.parent:this).$root.$options.shadowRoot)}:l),o)if(s.functional){s._injectStyles=o;var k=s.render;s.render=function(S,g){return o.call(g),k(S,g)}}else{var _=s.beforeCreate;s.beforeCreate=_?[].concat(_,o):[o]}return{exports:e,options:s}}const p={props:{label:String,buttonLabel:String,pageID:String,pageFields:Array,languages:Array,render:Boolean},data(){return{success:!1,syncFromLanguage:null,fieldsToSync:[]}},computed:{closeButtonTheme(){return this.success?"positive":"negative"},allowSync(){return!this.success&&this.syncFromLanguage&&this.fieldsToSync.length},otherLanguages(){return this.languages?Object.entries(this.languages).filter(e=>e[0]!==this.$language.code).map(e=>({value:e[0],text:e[1]})):[]},syncableFields(){return this.pageFields.map(e=>({value:e.name,text:e.label}))}},mounted(){this.pageFields.forEach(e=>this.fieldsToSync.push(e.name))},methods:{openDialog(){this.success=!1,this.$refs.dialog.open()},closeDialog(){this.$refs.dialog.close(),this.success=!1},syncFields(e){try{e.forEach(t=>{this.fieldsToSync.includes(t.name)&&this.$store.dispatch("content/update",[t.name,t.value])})}catch(t){console.error(t)}this.success=!0},getContentFromLanguage(){this.$api.post(`sync-lang/${encodeURIComponent(this.pageID)}`,{fromLang:this.syncFromLanguage}).then(e=>{e.success?this.syncFields(e.content):console.error("Response:",e)}).catch(e=>console.error(e))}}},c={};var v=f(p,d,h,!1,y,"8c88c81a",null,null);function y(e){for(let t in c)this[t]=c[t]}var m=function(){return v.exports}();window.panel.plugin("sietseveenman/kirby3-language-sync",{fields:{sync:m}})})();
